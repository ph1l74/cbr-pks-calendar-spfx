# cbr-pks-calendar-spfx

Календарь событий реализованный на Sharepoint Framework (SPFx).

## Запуск проекта
### Как запустить проект

```bash
git clone the repo
npm i
npm i -g gulp
gulp 
```
### При возникновении ошибок компилляции
```bash
npm install
npm run fixbuild
gulp bundle --ship
gulp package-solution --ship
```

При построении проекта будут созданы сделующие директории:

* lib/* - артифакты построения проекта промежуточной стадии.
* dist/* - итоговый бандл скриптв, включающий зависимости.
* deploy/* - все ресурсы, которые необходимо загрузить при деплое на CDN.

### Параметры построения проекта

gulp serve - запустить решение на локальном сервере SP Workbench.
gulp package-solution - упаковать решение.


## Компоненты
### RcrCalendar

Главный компонент. Используется в качестве контейнера.

### Content

Контейнер для отображения контента.

### Dashboard

Контейнер для отображения боковой панели.

### EventCard

Компонент карточки события. Отображает информацию по событию. Использует React Hooks (useState) для взаимодействия с состоянием компонента*. 

*в текущей реализации используются Api с заданным в конфигурации портом 85.

Примерная модель объекта с информацией о событии:

```javascript
[
	{
        "Key": "2020-06-01T00:00:00",
        "Value": [
			{
                "allDay": true,
                "attachmentsCount": 89,
                "category": {
                    "id": 1,
                    "name": "Мероприятия",
                    "color": "#000000"
                },
                "description":"<p> Метания копья в зале. </p>",
                "endDate": "2020-07-04T00:42:37.3002723",
                "feedbacksCount": 4,
                "freeVisit": true,
                "id": 17,
                "isParticipant": false,
                "linksCount": 98,
                "location": "Location 058",
                "participantsCount": 13,
                "startDate": "2020-06-16T00:42:37.3002723",
                "title": "Event 058"
            },
			...
		]
	},
	...
]
```

| Поле                  | Назначение                                                        | Тип           |
| --------------------- | ----------------------------------------------------------------- | ------------- |
| **Key**               | Поисковое значение запроса                                        | String        |
| **Value**             | Содержит поля dateFrom и dateTo                                   | Array<Object> |
| **allDay**            | Флаг, обозначающий событие на весь день                           | Boolean       |
| **attachmentsCount**  | Количество материалов события                                     | Number        |
| **category**          | Объект категории, содержит в себе название и цвет категории       | Object        |
| category.**id**       | ID категории                                                      | String        |
| category.**name**     | Имя категории                                                     | String        |
| category.**color**    | Цвет категории                                                    | String        |
| **description**       | Описание события, поддерживается html-разметка                    | String        |
| **endDate**           | Значение даты окончания события                                   | String*       |
| **feedbacksCount**    | Количество отзывов                                                | Number        |
| **freeVisit**         | Флаг, обозначающий статус свободного участия в событии            | Boolean       |
| **id**                | Идентификатор события                                             | Number        |
| **isParticipant**     | Флаг, обозначающий статус участия текущего пользователя в событии | Boolean       |
| **linksCount**        | Количество ссылок события                                         | Number        |
| **location**          | Место проведения                                                  | String        |
| **participantsCount** | Количество участников                                             | Number        |
| **startDate**         | Значение даты начала события                                      | String*       |
| **title**             | Название события                                                  | String        |

\* **endDate, startDate** - Запись осуществляется в формате ISO. Например: *"2020-10-05T14:48:00.000Z"*.  

## TODO
- [x]  EventCard: Привести стили карточки к виду ПКС.
- [x]  Написать компоненты модального окна.
- [x]  Подключить компонент Календаря.
- [x]  Обернуть в стор.
- [x]  Написать логику отображения редактирования и создания новых элементов.
- [x]  Фильтрация.
- [x]  Валидация.
- [x]  Работа с API.
- [x]  Исправление warning.
- [x]  Динамическая загрузка пользователей в компоненте выбора участников события.